{% extends 'layouts/base.html' %}
{% load static %}

{% block title %}
    مشاهده {{ part.title }}
{% endblock title %}

{% block css %}

<style>
   
    .h_iframe-aparat_embed_frame{
        position:relative;
    }
    .h_iframe-aparat_embed_frame .ratio{
        display:block;
        width:100%;
        height:auto;
    }
    .h_iframe-aparat_embed_frame iframe{
        position:absolute;
        top:0;left:0;
        width:100%;
        height:100%;
    }

    colgroup col {
        border: 1px solid black;
    }
    .col1 {
        width: 40%;
    }
    .col2 {
        width: 60%; 
    }

</style>

{% endblock css %}


{% block content %}
<section class="mt-4">
    <div class="container">
        <div class="">
            <div class="row">
                <div class="col-md-12" style="">
                    <h2 class="title">
                        محصول {{ part.part_index }} - {{ part.title }}
                    </h2>
                    <hr>
                    <table class="table table-stripped">
                        <colgroup>
                            <col class="col1">
                            <col class="col2">
                          </colgroup>
                        <tr>
                            {% comment %} <td><i class="fas fa-chalkboard-teacher"></i> استاد </td>
                            <td>{{ part.chapter.course.professor.full_name }}</td> {% endcomment %}
                            
                        </tr>
                        {% if part.chapter or part.course %}
                            <tr>
                                <td><i class="fas fa-chart-line"></i> پیشرفت </td>
                                <td>محصول {{ part.part_index }} از 
                                    {% if not part.chapter %}
                                        {{ part.course.parts.count }}
                                    {% else %}
                                        {{ part.chapter.parts.count }}  
                                    {% endif %}
                                </td>
                            </tr>
                        {% endif %}
                        <tr>
                            <td><i class="fas fa-clock"></i> زمان </td>
                            <td>{{ part.part_time }} دقیقه</td>
                        </tr>
                        <tr>
                            <td><i class="fas fa-eye"></i> تعداد دانشجو </td>
                            <td>
                                {% if not part.chapter or not part.course %}
                                    {{ part.get_student_count }}
                                {% elif not part.chapter %}
                                    {{ part.course.get_student_count }}
                                {% else %}
                                    {{ part.chapter.get_student_count }}  
                                {% endif %}    
                                دانشجو
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2" class="text-center">
                                {% if part.course %}
                                    <a href="{% url 'edu:course_detail' part.course.slug %}" class="">
                                        مشاهده سایر محصول
                                    </a>
                                {% elif part.chapter %}
                                    <a href="{% url 'edu:chapter_detail' part.chapter.slug %}" class="">
                                        مشاهده سایر محصول
                                    </a>
                                {% endif %}
                            </td>
                        </tr>
                    </table>
                </div>
                {% if show_buy_link != True %}
                    <div class=" col-md-12 p-2">
                        <div class="team-details-thumb">
                            <div class="h_iframe-aparat_embed_frame">
                                <span style="display: block;padding-top: 57%">

                                </span>
                                <iframe src="{{ part.video_link }}" frameborder="0"></iframe>
                            </div>
                        </div>
                    </div>
                {% else %}
                    <hr>
                    <p class="text-info">
                        برای مشاهده ویدئو، لطفا از بخش پایین آن را خریداری نمایید.
                    </p>
                    <div class="row mx-auto mt-4 mb-4">
                        <div class="card shadow">
                            <table class="table table-stripped table-hover">
                                <tr>
                                    <td>
                                        قیمت محصول
                                    </td>
                                    <td>
                                        {{ part.formatted_price }} تومان
                                    </td>
                                </tr>

                                {% if part.formatted_discount_price %}
                                    <tr>
                                        <td>
                                            قیمت قسمت با تخفیف
                                        </td>
                                        <td>
                                            {{ part.formatted_discount_price }} تومان
                                        </td>
                                    </tr>
                                {% endif %}
                                
                                <tr>
                                    <td colspan="2">
                                        <form action="{% url 'cart:item_add' part.id %}" method="GET">
                                            <button type="submit" class="btn btn-success w-100">اضافه کردن به سبد خرید</button>
                                            <input type="hidden" name="product_type" value="part">
                                        </form>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>

                {% endif %}
                
                <div class=" col-md-12 p-2 mt-2">
                    <p class=" text-justify">
                       {{ part.meta_description }}
                    </p>
                    <br>
                   <hr>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock content %}